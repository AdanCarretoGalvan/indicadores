{% extends 'base/base.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}



{% block extrahead %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<style type="text/css">
	#select{
            margin-top: 3px;
            padding: 8px;
            width: 400px;
        }
    #yearIni, #yearFin{
    	padding: 5px;
    	width: 500px;
    	border-radius: 5px;
    }
    #boton{
    	margin: 30px;
    	border-radius: 3px;
    	padding: 10px;
    }

</style>

{% endblock %}
{% block branding %}

{% endblock %}


{% block nav-global %}

{% endblock %}

{% block content %}

<h2 id="titulo" name="titulo" class="title">{% block encabezado%}{% endblock %}</h2>

<div class="tab">
      <button class="tablinks" onclick="openCity(event, 'datos')" id="id_datos">Datos</button>
      <button class="tablinks" onclick="openCity(event, 'grafica')" id="id_grafica">Gr치fica</button>
</div>

        <div id="datos" class="tabcontent">
                 <form method="POST" class="post-form" name="formulario" id="forma">{% csrf_token %}
                 	<div class="row">
    					<div class="col-md-8 col-md-offset-2">
      						<div class="form-group">
        						{{ form.id_carrera|as_crispy_field }}
      						</div>
    					</div>
    					<div class="col-md-4 col-md-offset-2">
      						<div class="form-group">
        					<label>Tipo de grafica: </label>
        					<select name="tipo" required id="select">
            					<option value="bar">Barras</option>
            					<option value="pie" >Circular</option>
            					<option value="line" >Lineal</option>
            					<option value="column" selected>Columnas</option>
        					</select>
      						</div>
    					</div>
    					<div class="col-md-12" align="left">
    						<h4>Generaci칩n</h4>
    					</div>
    					</br>
    					</br>
    					<div class="col-md-1 col-md-offset-2" align="right">
    						<label>Entre </label>
    					</div>
    					<div class="col-md-5 col-md-offset-2" align="left">
                    		<input type='number' placeholder="A침o de inicio" value="2015" name='ain' required min="1998" max="{{yea}}" id="yearIni" />
    					</div>
    					<div class="col-md-1 col-md-offset-2" align="left">
    						<label>     Y    </label>
    					</div>
    					<div class="col-md-5 col-md-offset-2" align="left">
    						<input type='number' placeholder="A침o de fin" value="2017" name='afi' required min="1998" max="{{yea}}" id="yearFin" />
    					</div>
                    		
    					<div class="container" align="center">
    						<input type="submit" value="Calcular" id="boton" class="btn btn-outline-info">
    					</div>                    
                    
                    <input type="number" value="{{bandera}}"  id="id_band" hidden="true">
                	</div>
                </form>
                <div id="container">
                </div>
        </div>

        <div id="grafica" class="tabcontent">
           <div id="container1">
           </div> 
        </div>
             
    <script src="https://code.highcharts.com/highcharts.src.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <script>
        Highcharts.chart('container1', {{ chart|safe }});
    </script>
<script type="text/javascript">
function asigna(){ 
        var ic = sessionStorage.getItem('idC');
        var tg = sessionStorage.getItem('grafica');
        var ai = sessionStorage.getItem('inio');
        var af = sessionStorage.getItem('fin');
        document.formulario.id_carrera.selectedIndex = ic;
        document.formulario.tipo.selectedIndex = tg;
        document.formulario.afi.value = af;
        
    }
    window.addEventListener('load', openCity(event, 'grafica'), false);
</script>
<script type="text/javascript">
    $(document).ready(function(){
        $('#forma').submit(function(event){
            var idCarrera = document.getElementById('id_id_carrera').selectedIndex;
            var tipoGrafica = document.getElementById('select').selectedIndex;
            var anoIni = document.getElementById('yearIni').value;
            var anoFin = document.getElementById('yearFin').value;
            sessionStorage.setItem('idC', idCarrera);
            sessionStorage.setItem('grafica', tipoGrafica);
            sessionStorage.setItem('inio', anoIni);
            sessionStorage.setItem('fin', anoFin);
        });
    });
</script>
{% endblock %}